<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Demonstration of latrend package â€¢ latrend</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Demonstration of latrend package">
<meta property="og:description" content="latrend">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">latrend</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/custom.html">Implementing new models</a>
    </li>
    <li>
      <a href="../articles/demo.html">Demonstration of latrend package</a>
    </li>
    <li>
      <a href="../articles/validation.html">Validating cluster models</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/philips-software/latrend/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="demo_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Demonstration of latrend package</h1>
                        <h4 class="author">Niek Den Teuling</h4>
            
            <h4 class="date">2021-10-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/philips-software/latrend/blob/master/vignettes/demo.Rmd"><code>vignettes/demo.Rmd</code></a></small>
      <div class="hidden name"><code>demo.Rmd</code></div>

    </div>

    
    
<p>This vignette describes the core functionality of the package by identifying common trends in the longitudinal dataset that is included with the package. We begin by loading the required package and the <code>latrendData</code> dataset.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/philips-software/latrend">latrend</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">latrendData</span><span class="op">)</span></code></pre></div>
<div id="initial-data-exploration" class="section level1">
<h1 class="hasAnchor">
<a href="#initial-data-exploration" class="anchor"></a>Initial data exploration</h1>
<p>The <code>latrendData</code> is a synthetic dataset for which the reference group of each trajectory is available, as indicated by the <code>Class</code> column. We will use this column at the end of this vignette to validate the identified model.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">latrendData</span><span class="op">)</span>
<span class="co">#&gt;   Id      Time           Y   Class</span>
<span class="co">#&gt; 1  1 0.0000000 -1.08049205 Class 1</span>
<span class="co">#&gt; 2  1 0.2222222 -0.68024151 Class 1</span>
<span class="co">#&gt; 3  1 0.4444444 -0.65148373 Class 1</span>
<span class="co">#&gt; 4  1 0.6666667 -0.39115398 Class 1</span>
<span class="co">#&gt; 5  1 0.8888889 -0.19407876 Class 1</span>
<span class="co">#&gt; 6  1 1.1111111 -0.02991783 Class 1</span></code></pre></div>
<p>Many of the functions of the package require the specification of the trajectory identifier variable (named <code>Id</code>) and the time variable (named <code>Time</code>). For convenience, we specify these variables as package options.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>latrend.id <span class="op">=</span> <span class="st">"Id"</span>, latrend.time <span class="op">=</span> <span class="st">"Time"</span><span class="op">)</span></code></pre></div>
<p>Prior to attempting to model the data, it is worthwhile to visually inspect it.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotTrajectories.html">plotTrajectories</a></span><span class="op">(</span><span class="va">latrendData</span>, response <span class="op">=</span> <span class="st">"Y"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<p class="caption">
Visualizing the trajectories of the <code>latrend</code> dataset.
</p>
<img src="demo_files/figure-html/unnamed-chunk-4-1.png" alt="Visualizing the trajectories of the `latrend` dataset." width="672">
</div>
<p>The presence of clusters is not apparent from the plot. With any longitudinal analysis, one should first consider whether clustering brings any benefit to the representation of heterogeneity of the data over a single common trend representation, or a multilevel model. In this demonstration, we omit this step under the prior knowledge that the data was generated via distinct mechanisms.</p>
</div>
<div id="non-parametric-trajectory-clustering" class="section level1">
<h1 class="hasAnchor">
<a href="#non-parametric-trajectory-clustering" class="anchor"></a>Non-parametric trajectory clustering</h1>
<p>Assuming the appropriate (cluster) trajectory model is not known in advance, non-parametric longitudinal cluster models can provide a suitable starting point.</p>
<p>As an example, we apply longitudinal <span class="math inline">\(k\)</span>-means (KML). First, we need to define the method. At the very least we need to indicate the response variable the method should operate on. Secondly, we should indicate how many clusters we expect. We do not need to define the <code>id</code> and <code>time</code> arguments as we have set these as package options. We use the <code>nbRedrawing</code> argument provided by the KML package for reducing the number of repeated random starts to only a single model estimation, in order to reduce the run-time of this example.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">kmlMethod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcMethodKML.html">lcMethodKML</a></span><span class="op">(</span>response <span class="op">=</span> <span class="st">"Y"</span>, nClusters <span class="op">=</span> <span class="fl">2</span>, nbRedrawing <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="va">kmlMethod</span>
<span class="co">#&gt; lcMethodKML specifying "longitudinal k-means (KML)"</span>
<span class="co">#&gt;  time:           getOption("latrend.time")</span>
<span class="co">#&gt;  id:             getOption("latrend.id")</span>
<span class="co">#&gt;  nClusters:      2</span>
<span class="co">#&gt;  nbRedrawing:    1</span>
<span class="co">#&gt;  maxIt:          200</span>
<span class="co">#&gt;  imputationMethod:"copyMean"</span>
<span class="co">#&gt;  distanceName:   "euclidean"</span>
<span class="co">#&gt;  power:          2</span>
<span class="co">#&gt;  distance:       function() {}</span>
<span class="co">#&gt;  centerMethod:   meanNA</span>
<span class="co">#&gt;  startingCond:   "nearlyAll"</span>
<span class="co">#&gt;  nbCriterion:    1000</span>
<span class="co">#&gt;  scale:          TRUE</span>
<span class="co">#&gt;  response:       "Y"</span></code></pre></div>
<p>As seen in the output from the <code>lcMethodKML</code> object, the KML method is defined by additional arguments. These are specific to the <code>kml</code> package.</p>
<p>The KML model is estimated on the dataset via the <code>latrend</code> function.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">kmlModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/latrend.html">latrend</a></span><span class="op">(</span><span class="va">kmlMethod</span>, data <span class="op">=</span> <span class="va">latrendData</span><span class="op">)</span>
<span class="co">#&gt;  ~ Fast KmL ~</span>
<span class="co">#&gt; *S</span></code></pre></div>
<p>Now that we have fitted the KML model with 2 clusters, we can print a summary by calling:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">kmlModel</span>
<span class="co">#&gt; Longitudinal cluster model using longitudinal k-means (KML)</span>
<span class="co">#&gt; lcMethodKML specifying "longitudinal k-means (KML)"</span>
<span class="co">#&gt;  time:           "Time"</span>
<span class="co">#&gt;  id:             "Id"</span>
<span class="co">#&gt;  nClusters:      2</span>
<span class="co">#&gt;  nbRedrawing:    1</span>
<span class="co">#&gt;  maxIt:          200</span>
<span class="co">#&gt;  imputationMethod:"copyMean"</span>
<span class="co">#&gt;  distanceName:   "euclidean"</span>
<span class="co">#&gt;  power:          2</span>
<span class="co">#&gt;  distance:       function () {}</span>
<span class="co">#&gt;  centerMethod:   function (x) {    mean(x, na.rm = TRUE)}</span>
<span class="co">#&gt;  startingCond:   "nearlyAll"</span>
<span class="co">#&gt;  nbCriterion:    1000</span>
<span class="co">#&gt;  scale:          TRUE</span>
<span class="co">#&gt;  response:       "Y"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Cluster sizes (K=2):</span>
<span class="co">#&gt;         A         B </span>
<span class="co">#&gt; 110 (55%)  90 (45%) </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Number of obs: 2000, strata (Id): 200</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Scaled residuals:</span>
<span class="co">#&gt;     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. </span>
<span class="co">#&gt; -3.83836 -0.60818  0.02327  0.00000  0.64356  3.49294</span></code></pre></div>
<div id="identifying-the-number-of-clusters" class="section level2">
<h2 class="hasAnchor">
<a href="#identifying-the-number-of-clusters" class="anchor"></a>Identifying the number of clusters</h2>
<p>As we do not know the best number of clusters needed to represent the data, we should consider fitting the KML model for a range of clusters. We can then select the best representation by comparing the solutions by one or more cluster metrics.</p>
<p>We can specify a range of <code>lcMethodKML</code> methods based on a prototype method using the <code>lcMethods</code> function. This method outputs a list of <code>lcMethod</code> objects. A structured summary is obtained by calling <code>as.data.frame</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">kmlMethods</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcMethods.html">lcMethods</a></span><span class="op">(</span><span class="va">kmlMethod</span>, nClusters <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">kmlMethods</span><span class="op">)</span>
<span class="co">#&gt;        .class time id nClusters nbRedrawing maxIt imputationMethod distanceName</span>
<span class="co">#&gt; 1 lcMethodKML Time Id         1           1   200         copyMean    euclidean</span>
<span class="co">#&gt; 2 lcMethodKML Time Id         2           1   200         copyMean    euclidean</span>
<span class="co">#&gt; 3 lcMethodKML Time Id         3           1   200         copyMean    euclidean</span>
<span class="co">#&gt; 4 lcMethodKML Time Id         4           1   200         copyMean    euclidean</span>
<span class="co">#&gt; 5 lcMethodKML Time Id         5           1   200         copyMean    euclidean</span>
<span class="co">#&gt; 6 lcMethodKML Time Id         6           1   200         copyMean    euclidean</span>
<span class="co">#&gt; 7 lcMethodKML Time Id         7           1   200         copyMean    euclidean</span>
<span class="co">#&gt; 8 lcMethodKML Time Id         8           1   200         copyMean    euclidean</span>
<span class="co">#&gt;   power      distance centerMethod startingCond nbCriterion scale response</span>
<span class="co">#&gt; 1     2 function() {}       meanNA    nearlyAll        1000  TRUE        Y</span>
<span class="co">#&gt; 2     2 function() {}       meanNA    nearlyAll        1000  TRUE        Y</span>
<span class="co">#&gt; 3     2 function() {}       meanNA    nearlyAll        1000  TRUE        Y</span>
<span class="co">#&gt; 4     2 function() {}       meanNA    nearlyAll        1000  TRUE        Y</span>
<span class="co">#&gt; 5     2 function() {}       meanNA    nearlyAll        1000  TRUE        Y</span>
<span class="co">#&gt; 6     2 function() {}       meanNA    nearlyAll        1000  TRUE        Y</span>
<span class="co">#&gt; 7     2 function() {}       meanNA    nearlyAll        1000  TRUE        Y</span>
<span class="co">#&gt; 8     2 function() {}       meanNA    nearlyAll        1000  TRUE        Y</span></code></pre></div>
<p>The list of <code>lcMethod</code> objects can be fitted using the <code>latrendBatch</code> function, returning a list of <code>lcModel</code> objects.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">kmlModels</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/latrendBatch.html">latrendBatch</a></span><span class="op">(</span><span class="va">kmlMethods</span>, data <span class="op">=</span> <span class="va">latrendData</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="va">kmlModels</span>
<span class="co">#&gt; List of 8 lcModels with</span>
<span class="co">#&gt;   .name .method       seed nClusters</span>
<span class="co">#&gt; 1     1     kml 1753232290         1</span>
<span class="co">#&gt; 2     2     kml 1711075799         2</span>
<span class="co">#&gt; 3     3     kml  690659598         3</span>
<span class="co">#&gt; 4     4     kml  265368763         4</span>
<span class="co">#&gt; 5     5     kml  758296545         5</span>
<span class="co">#&gt; 6     6     kml 1649722645         6</span>
<span class="co">#&gt; 7     7     kml 2137634742         7</span>
<span class="co">#&gt; 8     8     kml 2112708938         8</span></code></pre></div>
<p>We can compare each of the solutions via one or more cluster metrics. Considering the consistent improvements achieved by KML for an increasing number of clusters, identifying the best solution by minimizing a metric would lead to an overestimation. Instead, we perform the selection via a manual elbow method, using the <code>plotMetric</code> function.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotMetric.html">plotMetric</a></span><span class="op">(</span><span class="va">kmlModels</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"logLik"</span>, <span class="st">"BIC"</span>, <span class="st">"WMAE"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<p class="caption">
Elbow plots of three relevant cluster metrics across the fitted models.
</p>
<img src="demo_files/figure-html/unnamed-chunk-10-1.png" alt="Elbow plots of three relevant cluster metrics across the fitted models." width="672">
</div>
</div>
<div id="investigating-the-preferred-model" class="section level2">
<h2 class="hasAnchor">
<a href="#investigating-the-preferred-model" class="anchor"></a>Investigating the preferred model</h2>
<p>We have selected the 4-cluster model as the preferred representation. We will now inspect this solution in more detail. Before we can start, we first obtain the fitted <code>lcModel</code> object from the list of fitted models.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">kmlModel4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/subset.data.table.html">subset</a></span><span class="op">(</span><span class="va">kmlModels</span>, <span class="va">nClusters</span> <span class="op">==</span> <span class="fl">4</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="va">kmlModel4</span>
<span class="co">#&gt; Longitudinal cluster model using longitudinal k-means (KML)</span>
<span class="co">#&gt; lcMethodKML specifying "longitudinal k-means (KML)"</span>
<span class="co">#&gt;  seed:           265368763</span>
<span class="co">#&gt;  time:           "Time"</span>
<span class="co">#&gt;  id:             "Id"</span>
<span class="co">#&gt;  nClusters:      4</span>
<span class="co">#&gt;  nbRedrawing:    1</span>
<span class="co">#&gt;  maxIt:          200</span>
<span class="co">#&gt;  imputationMethod:"copyMean"</span>
<span class="co">#&gt;  distanceName:   "euclidean"</span>
<span class="co">#&gt;  power:          2</span>
<span class="co">#&gt;  distance:       function () {}</span>
<span class="co">#&gt;  centerMethod:   function (x) {    mean(x, na.rm = TRUE)}</span>
<span class="co">#&gt;  startingCond:   "nearlyAll"</span>
<span class="co">#&gt;  nbCriterion:    1000</span>
<span class="co">#&gt;  scale:          TRUE</span>
<span class="co">#&gt;  response:       "Y"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Cluster sizes (K=4):</span>
<span class="co">#&gt;          A          B          C          D </span>
<span class="co">#&gt;  100 (50%) 54 (27.3%) 25 (12.4%) 21 (10.3%) </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Number of obs: 2000, strata (Id): 200</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Scaled residuals:</span>
<span class="co">#&gt;     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. </span>
<span class="co">#&gt; -4.58872 -0.60854  0.04235  0.00000  0.65970  3.23364</span></code></pre></div>
<p>The <code>plotClusterTrajectories</code> function shows the estimated cluster trajectories of the model.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotClusterTrajectories.html">plotClusterTrajectories</a></span><span class="op">(</span><span class="va">kmlModel4</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<p class="caption">
Cluster trajectories for KML model with 4 clusters.
</p>
<img src="demo_files/figure-html/unnamed-chunk-12-1.png" alt="Cluster trajectories for KML model with 4 clusters." width="672">
</div>
<p>We can get a better sense of the representation of the cluster trajectories when plotted against the trajectories that have been assigned to the respective cluster.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">kmlModel4</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<p class="caption">
Cluster trajectories for KML model with 4 clusters, along with the assigned trajectories.
</p>
<img src="demo_files/figure-html/unnamed-chunk-13-1.png" alt="Cluster trajectories for KML model with 4 clusters, along with the assigned trajectories." width="672">
</div>
</div>
<div id="model-adequacy" class="section level2">
<h2 class="hasAnchor">
<a href="#model-adequacy" class="anchor"></a>Model adequacy</h2>
<p>The list of currently supported internal model metrics can be obtained by calling the <code>getInternalMetricNames</code> function.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/getInternalMetricNames.html">getInternalMetricNames</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt;  [1] "AIC"             "APPA"            "BIC"             "converged"      </span>
<span class="co">#&gt;  [5] "deviance"        "entropy"         "estimationTime"  "logLik"         </span>
<span class="co">#&gt;  [9] "MAE"             "MSE"             "relativeEntropy" "RSS"            </span>
<span class="co">#&gt; [13] "sigma"           "WMAE"            "WMSE"            "WRSS"</span></code></pre></div>
<p>As an example, we will compute the APPA (a measure of cluster separation), and the WRSS and WMAE metrics (measures of model error).</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/metric.html">metric</a></span><span class="op">(</span><span class="va">kmlModel</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"APPA"</span>, <span class="st">"WRSS"</span>, <span class="st">"WMAE"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;        APPA        WRSS        WMAE </span>
<span class="co">#&gt;   0.9996480 167.8058270   0.2247193</span></code></pre></div>
<p>The quantile-quantile (QQ) plot can be used to assess the model for structural deviations.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/qqPlot.html">qqPlot</a></span><span class="op">(</span><span class="va">kmlModel4</span><span class="op">)</span>
<span class="co">#&gt; Loading required namespace: qqplotr</span></code></pre></div>
<div class="figure" style="text-align: center">
<p class="caption">
QQ-plot of the selected KML model.
</p>
<img src="demo_files/figure-html/unnamed-chunk-16-1.png" alt="QQ-plot of the selected KML model." width="480">
</div>
<p>Overall, the unexplained errors closely follow a normal distribution. In situations where structural deviations from the expected distribution are apparent, it may be fruitful to investigate the QQ plot on a per-cluster basis.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/qqPlot.html">qqPlot</a></span><span class="op">(</span><span class="va">kmlModel4</span>, byCluster <span class="op">=</span> <span class="cn">TRUE</span>, detrend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<p class="caption">
Cluster-specific detrended QQ-plot for the selected KML model.
</p>
<img src="demo_files/figure-html/unnamed-chunk-17-1.png" alt="Cluster-specific detrended QQ-plot for the selected KML model." width="672">
</div>
</div>
</div>
<div id="parametric-trajectory-clustering" class="section level1">
<h1 class="hasAnchor">
<a href="#parametric-trajectory-clustering" class="anchor"></a>Parametric trajectory clustering</h1>
<div id="group-based-trajectory-modeling" class="section level2">
<h2 class="hasAnchor">
<a href="#group-based-trajectory-modeling" class="anchor"></a>Group-based trajectory modeling</h2>
<p>The KML analysis has provided us with clues on an appropriate model for the cluster trajectories. We can use these insights to define a parametric group-based trajectory model (GBTM) with cluster trajectories represented by polynomials of order 2. We will use the GBTM implementation available from the <code>lcmm</code> package, using a B-spline trajectory of degree 3 from the <code>splines</code> package.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">splines</span><span class="op">)</span>
<span class="va">gbtmMethod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcMethodLcmmGBTM.html">lcMethodLcmmGBTM</a></span><span class="op">(</span>fixed <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/splines/bs.html">bs</a></span><span class="op">(</span><span class="va">Time</span><span class="op">)</span>, mixture <span class="op">=</span> <span class="va">fixed</span><span class="op">)</span>

<span class="va">gbtmMethod</span>
<span class="co">#&gt; lcMethodLcmmGBTM specifying "group-based trajectory modeling using lcmm"</span>
<span class="co">#&gt;  mixture:        fixed</span>
<span class="co">#&gt;  classmb:        ~1</span>
<span class="co">#&gt;  time:           getOption("latrend.time")</span>
<span class="co">#&gt;  id:             getOption("latrend.id")</span>
<span class="co">#&gt;  nClusters:      2</span>
<span class="co">#&gt;  init:           "lme"</span>
<span class="co">#&gt;  idiag:          FALSE</span>
<span class="co">#&gt;  nwg:            FALSE</span>
<span class="co">#&gt;  cor:            NULL</span>
<span class="co">#&gt;  convB:          1e-04</span>
<span class="co">#&gt;  convL:          1e-04</span>
<span class="co">#&gt;  convG:          1e-04</span>
<span class="co">#&gt;  maxiter:        500</span>
<span class="co">#&gt;  subset:         NULL</span>
<span class="co">#&gt;  na.action:      1</span>
<span class="co">#&gt;  posfix:         NULL</span>
<span class="co">#&gt;  fixed:          Y ~ bs(Time)</span></code></pre></div>
<p>We fit the GBTM for 1 to 5 clusters.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gbtmMethods</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcMethods.html">lcMethods</a></span><span class="op">(</span><span class="va">gbtmMethod</span>, nClusters <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>

<span class="va">gbtmModels</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/latrendBatch.html">latrendBatch</a></span><span class="op">(</span><span class="va">gbtmMethods</span>, data <span class="op">=</span> <span class="va">latrendData</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotMetric.html">plotMetric</a></span><span class="op">(</span><span class="va">gbtmModels</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"logLik"</span>, <span class="st">"BIC"</span>, <span class="st">"WMAE"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<p class="caption">
Three cluster metrics for each of the GBTMs.
</p>
<img src="demo_files/figure-html/unnamed-chunk-20-1.png" alt="Three cluster metrics for each of the GBTMs." width="672">
</div>
<p>All metrics clearly point to the 3-cluster solution.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bestGbtmModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/subset.data.table.html">subset</a></span><span class="op">(</span><span class="va">gbtmModels</span>, <span class="va">nClusters</span> <span class="op">==</span> <span class="fl">3</span>, drop<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">bestGbtmModel</span><span class="op">)</span></code></pre></div>
<p><img src="demo_files/figure-html/unnamed-chunk-21-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="growth-mixture-modeling" class="section level2">
<h2 class="hasAnchor">
<a href="#growth-mixture-modeling" class="anchor"></a>Growth mixture modeling</h2>
<p>We have identified 3 apparent clusters via GBTM. However, we may wish to obtain a model that betters explains the within-cluster heterogeneity (as seen in the cluster trajectories plot above). We apply a growth mixture model (GMM) using trajectories represented by a second-order polynomial.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gmmMethod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcMethodLcmmGMM.html">lcMethodLcmmGMM</a></span><span class="op">(</span>fixed <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">Time</span>, <span class="fl">2</span>, raw <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, mixture <span class="op">=</span> <span class="va">fixed</span>, idiag <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="va">gmmMethod</span>
<span class="co">#&gt; lcMethodLcmmGMM specifying "growth mixture model"</span>
<span class="co">#&gt;  mixture:        fixed</span>
<span class="co">#&gt;  random:         ~1</span>
<span class="co">#&gt;  classmb:        ~1</span>
<span class="co">#&gt;  time:           getOption("latrend.time")</span>
<span class="co">#&gt;  id:             getOption("latrend.id")</span>
<span class="co">#&gt;  init:           "lme.random"</span>
<span class="co">#&gt;  nClusters:      2</span>
<span class="co">#&gt;  idiag:          TRUE</span>
<span class="co">#&gt;  nwg:            FALSE</span>
<span class="co">#&gt;  cor:            NULL</span>
<span class="co">#&gt;  convB:          1e-04</span>
<span class="co">#&gt;  convL:          1e-04</span>
<span class="co">#&gt;  convG:          1e-04</span>
<span class="co">#&gt;  maxiter:        500</span>
<span class="co">#&gt;  na.action:      1</span>
<span class="co">#&gt;  posfix:         NULL</span>
<span class="co">#&gt;  fixed:          Y ~ poly(Time, 2, raw = TRUE)</span></code></pre></div>
<p>We fit the GMM for 1 to 5 clusters.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gmmMethods</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcMethods.html">lcMethods</a></span><span class="op">(</span><span class="va">gmmMethod</span>, nClusters <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>

<span class="va">gmmModels</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/latrendBatch.html">latrendBatch</a></span><span class="op">(</span><span class="va">gmmMethods</span>, <span class="va">latrendData</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotMetric.html">plotMetric</a></span><span class="op">(</span><span class="va">gmmModels</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"logLik"</span>, <span class="st">"BIC"</span>, <span class="st">"WMAE"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<p class="caption">
Three cluster metrics for each of the GMMs.
</p>
<img src="demo_files/figure-html/unnamed-chunk-24-1.png" alt="Three cluster metrics for each of the GMMs." width="672">
</div>
<p>Similar to the GBTM analysis, the metrics clearly point to the 3-cluster solution.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bestGmmModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/subset.data.table.html">subset</a></span><span class="op">(</span><span class="va">gmmModels</span>, <span class="va">nClusters</span> <span class="op">==</span> <span class="fl">3</span>, drop<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">bestGmmModel</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<p class="caption">
Cluster trajectories of the selected GMM, including the assigned trajectories.
</p>
<img src="demo_files/figure-html/unnamed-chunk-26-1.png" alt="Cluster trajectories of the selected GMM, including the assigned trajectories." width="672">
</div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/qqPlot.html">qqPlot</a></span><span class="op">(</span><span class="va">bestGmmModel</span>, detrend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<p class="caption">
Detrended QQ plot for the best GMM.
</p>
<img src="demo_files/figure-html/unnamed-chunk-27-1.png" alt="Detrended QQ plot for the best GMM." width="480">
</div>
<p>As can be seen by the scale of the y-axis of the QQ plot, the deviations from the expected normal distributions are negligibly small.</p>
</div>
<div id="comparing-models" class="section level2">
<h2 class="hasAnchor">
<a href="#comparing-models" class="anchor"></a>Comparing models</h2>
<p>Both the GBTM and GMM analysis indicated the data was best represented using 3 clusters. We are interested in identifying the best representation for the data. After all, despite the matching number of clusters, there may be differences between the models in terms of trajectory assignments are shape of the cluster trajectories.</p>
<p>Firstly, we compare the fit to the data by comparing the BIC, which indicates that the GMM model is marginally better than the GBTM model.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">BIC</a></span><span class="op">(</span><span class="va">bestGbtmModel</span>, <span class="va">bestGmmModel</span><span class="op">)</span>
<span class="co">#&gt;               df        BIC</span>
<span class="co">#&gt; bestGbtmModel 15   574.0813</span>
<span class="co">#&gt; bestGmmModel  13 -1672.9493</span></code></pre></div>
<p>Secondly, we compare the model fit errors, showing an identical error between models.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/metric.html">metric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">bestGbtmModel</span>, <span class="va">bestGmmModel</span><span class="op">)</span>, <span class="st">'WMAE'</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.19225404 0.08855489</span></code></pre></div>
<p>Thirdly, we can compare the weighted minimum MAE between the cluster trajectories of the models, as a measure of agreement in cluster trajectory shapes.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/externalMetric,lcModel,lcModel-method.html">externalMetric</a></span><span class="op">(</span><span class="va">bestGbtmModel</span>, <span class="va">bestGmmModel</span>, <span class="st">'WMMAE'</span><span class="op">)</span>
<span class="co">#&gt;      WMMAE </span>
<span class="co">#&gt; 0.05559308</span></code></pre></div>
<p>Lastly, we evaluate the agreement in trajectory assignments to the clusters using the adjusted Rand index (ARI). This intuitive index considers the co-assignments of trajectories, and corrects for agreements between the partitionings by random chance. A score of zero indicates a match no better than chance, whereas a score of 1 indicates a perfect agreement.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/externalMetric,lcModel,lcModel-method.html">externalMetric</a></span><span class="op">(</span><span class="va">bestGbtmModel</span>, <span class="va">bestGmmModel</span>, <span class="st">'adjustedRand'</span><span class="op">)</span>
<span class="co">#&gt; adjustedRand </span>
<span class="co">#&gt;    0.4770003</span></code></pre></div>
<p>The ARI of 1.0 demonstrates that the cluster assignments of the models are identical.</p>
</div>
</div>
<div id="comparison-to-the-reference" class="section level1">
<h1 class="hasAnchor">
<a href="#comparison-to-the-reference" class="anchor"></a>Comparison to the reference</h1>
<p>Since we have established a preferred clustered representation of the data heterogeneity, we can now compare the resulting cluster assignments to the ground truth from which the <code>latrendData</code> data was generated.</p>
<p>Using the reference assignments, we can also plot a non-parametric estimate of the cluster trajectories. Note how it looks similar to the cluster trajectories found by our model.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plotClusterTrajectories.html">plotClusterTrajectories</a></span><span class="op">(</span><span class="va">latrendData</span>, response <span class="op">=</span> <span class="st">"Y"</span>, cluster <span class="op">=</span> <span class="st">"Class"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<p class="caption">
Non-parametric estimates of the cluster trajectories based on the reference assignments.
</p>
<img src="demo_files/figure-html/unnamed-chunk-32-1.png" alt="Non-parametric estimates of the cluster trajectories based on the reference assignments." width="480">
</div>
<p>In order to compare the reference assignments to the trajectory assignments generated by our model, we can create a <code>lcModel</code> object based on the reference assignments using the <code>lcModelPartition</code> function.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">refTrajAssigns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">Id</span>, data <span class="op">=</span> <span class="va">latrendData</span>, FUN <span class="op">=</span> <span class="fu">data.table</span><span class="fu">::</span><span class="va"><a href="https://Rdatatable.gitlab.io/data.table/reference/last.html">first</a></span><span class="op">)</span>
<span class="va">refModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcModelPartition.html">lcModelPartition</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">latrendData</span>, response <span class="op">=</span> <span class="st">"Y"</span>, trajectoryAssignments <span class="op">=</span> <span class="va">refTrajAssigns</span><span class="op">$</span><span class="va">Class</span><span class="op">)</span>
<span class="va">refModel</span>
<span class="co">#&gt; Longitudinal cluster model using part</span>
<span class="co">#&gt; lcMethod specifying "undefined"</span>
<span class="co">#&gt; no arguments</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Cluster sizes (K=3):</span>
<span class="co">#&gt;  Class 1  Class 2  Class 3 </span>
<span class="co">#&gt; 90 (45%) 80 (40%) 30 (15%) </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Number of obs: 2000, strata (Id): 200</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Scaled residuals:</span>
<span class="co">#&gt;     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. </span>
<span class="co">#&gt; -3.33030 -0.59503 -0.02617  0.00000  0.59606  3.40645</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">refModel</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<p class="caption">
Cluster trajectories of the reference model.
</p>
<img src="demo_files/figure-html/unnamed-chunk-34-1.png" alt="Cluster trajectories of the reference model." width="672">
</div>
<p>By constructing a reference model, we can make use of the standardized way in which <code>lcModel</code> objects can be compared. A list of supported comparison metrics can be obtained via the <code>getExternalMetricNames</code> function.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/getExternalMetricNames.html">getExternalMetricNames</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt;  [1] "adjustedRand"   "CohensKappa"    "F"              "F1"            </span>
<span class="co">#&gt;  [5] "FolkesMallows"  "Hubert"         "Jaccard"        "jointEntropy"  </span>
<span class="co">#&gt;  [9] "Kulczynski"     "MaximumMatch"   "McNemar"        "MeilaHeckerman"</span>
<span class="co">#&gt; [13] "MI"             "Mirkin"         "NMI"            "NSJ"           </span>
<span class="co">#&gt; [17] "NVI"            "Overlap"        "PD"             "Phi"           </span>
<span class="co">#&gt; [21] "precision"      "Rand"           "recall"         "RogersTanimoto"</span>
<span class="co">#&gt; [25] "RusselRao"      "SMC"            "SokalSneath1"   "SokalSneath2"  </span>
<span class="co">#&gt; [29] "splitJoin"      "splitJoin_ref"  "VI"             "Wallace1"      </span>
<span class="co">#&gt; [33] "Wallace2"       "WMMAE"          "WMMAE_ref"      "WMMSE"         </span>
<span class="co">#&gt; [37] "WMMSE_ref"      "WMSSE"          "WMSSE_ref"</span></code></pre></div>
<p>Lastly, we compare the agreement in trajectory assignments via the adjusted Rand index.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/externalMetric,lcModel,lcModel-method.html">externalMetric</a></span><span class="op">(</span><span class="va">bestGmmModel</span>, <span class="va">refModel</span>, <span class="st">"adjustedRand"</span><span class="op">)</span>
<span class="co">#&gt; adjustedRand </span>
<span class="co">#&gt;    0.9883837</span></code></pre></div>
<p>With a score of <code><a href="../reference/externalMetric,lcModel,lcModel-method.html">externalMetric(bestGmmModel, refModel, "adjustedRand")</a></code>, we have a near-perfect match. This result is expected, as the dataset was generated using a growth mixture model.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Niek Den Teuling.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
