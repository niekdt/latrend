<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Demonstration of latrend package â€¢ latrend</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Demonstration of latrend package">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">latrend</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.6.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/demo.html">Demonstration of latrend package</a>
    </li>
    <li>
      <a href="../articles/implement.html">Implementing new methods</a>
    </li>
    <li>
      <a href="../articles/simulation.html">Conducting a simulation study</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/niekdt/latrend/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Demonstration of latrend package</h1>
                        <h4 data-toc-skip class="author">Niek Den
Teuling</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/niekdt/latrend/blob/master/vignettes/demo.Rmd" class="external-link"><code>vignettes/demo.Rmd</code></a></small>
      <div class="hidden name"><code>demo.Rmd</code></div>

    </div>

    
    
<p>This vignette describes the core functionality of the package by
identifying common trends in the longitudinal dataset that is included
with the package. We begin by loading the required package and the
<code>latrendData</code> dataset.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/niekdt/latrend" class="external-link">latrend</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="initial-data-exploration">Initial data exploration<a class="anchor" aria-label="anchor" href="#initial-data-exploration"></a>
</h2>
<p>The <code>latrendData</code> is a synthetic dataset for which the
reference group of each trajectory is available, as indicated by the
<code>Class</code> column. We will use this column at the end of this
vignette to validate the identified model.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">latrendData</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">latrendData</span><span class="op">)</span></span></code></pre></div>
<p>Many of the functions of the package require the specification of the
trajectory identifier variable (named <code>Id</code>) and the time
variable (named <code>Time</code>). For convenience, we specify these
variables as package options.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>latrend.id <span class="op">=</span> <span class="st">"Id"</span>, latrend.time <span class="op">=</span> <span class="st">"Time"</span><span class="op">)</span></span></code></pre></div>
<p>Prior to attempting to model the data, it is worthwhile to visually
inspect it.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotTrajectories.html">plotTrajectories</a></span><span class="op">(</span><span class="va">latrendData</span>, response <span class="op">=</span> <span class="st">"Y"</span><span class="op">)</span></span></code></pre></div>
<p>The presence of clusters is not apparent from the plot. With any
longitudinal analysis, one should first consider whether clustering
brings any benefit to the representation of heterogeneity of the data
over a single common trend representation, or a multilevel model. In
this demonstration, we omit this step under the prior knowledge that the
data was generated via distinct mechanisms.</p>
</div>
<div class="section level2">
<h2 id="non-parametric-trajectory-clustering">Non-parametric trajectory clustering<a class="anchor" aria-label="anchor" href="#non-parametric-trajectory-clustering"></a>
</h2>
<p>Assuming the appropriate (cluster) trajectory model is not known in
advance, non-parametric longitudinal cluster models can provide a
suitable starting point.</p>
<p>As an example, we apply longitudinal
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>-means
(KML). First, we need to define the method. At the very least we need to
indicate the response variable the method should operate on. Secondly,
we should indicate how many clusters we expect. We do not need to define
the <code>id</code> and <code>time</code> arguments as we have set these
as package options. We use the <code>nbRedrawing</code> argument
provided by the KML package for reducing the number of repeated random
starts to only a single model estimation, in order to reduce the
run-time of this example.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kmlMethod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcMethodKML.html">lcMethodKML</a></span><span class="op">(</span>response <span class="op">=</span> <span class="st">"Y"</span>, nClusters <span class="op">=</span> <span class="fl">2</span>, nbRedrawing <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">kmlMethod</span></span></code></pre></div>
<p>As seen in the output from the <code>lcMethodKML</code> object, the
KML method is defined by additional arguments. These are specific to the
<code>kml</code> package.</p>
<p>The KML model is estimated on the dataset via the
<code>latrend</code> function.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kmlModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/latrend.html">latrend</a></span><span class="op">(</span><span class="va">kmlMethod</span>, data <span class="op">=</span> <span class="va">latrendData</span><span class="op">)</span></span></code></pre></div>
<p>Now that we have fitted the KML model with 2 clusters, we can print a
summary by calling:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kmlModel</span></span></code></pre></div>
<div class="section level3">
<h3 id="identifying-the-number-of-clusters">Identifying the number of clusters<a class="anchor" aria-label="anchor" href="#identifying-the-number-of-clusters"></a>
</h3>
<p>As we do not know the best number of clusters needed to represent the
data, we should consider fitting the KML model for a range of clusters.
We can then select the best representation by comparing the solutions by
one or more cluster metrics.</p>
<p>We can specify a range of <code>lcMethodKML</code> methods based on a
prototype method using the <code>lcMethods</code> function. This method
outputs a list of <code>lcMethod</code> objects. A structured summary is
obtained by calling <code>as.data.frame</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kmlMethods</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcMethods.html">lcMethods</a></span><span class="op">(</span><span class="va">kmlMethod</span>, nClusters <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">kmlMethods</span><span class="op">)</span></span></code></pre></div>
<p>The list of <code>lcMethod</code> objects can be fitted using the
<code>latrendBatch</code> function, returning a list of
<code>lcModel</code> objects.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kmlModels</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/latrendBatch.html">latrendBatch</a></span><span class="op">(</span><span class="va">kmlMethods</span>, data <span class="op">=</span> <span class="va">latrendData</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">kmlModels</span></span></code></pre></div>
<p>We can compare each of the solutions via one or more cluster metrics.
Considering the consistent improvements achieved by KML for an
increasing number of clusters, identifying the best solution by
minimizing a metric would lead to an overestimation. Instead, we perform
the selection via a manual elbow method, using the
<code>plotMetric</code> function.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotMetric.html">plotMetric</a></span><span class="op">(</span><span class="va">kmlModels</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logLik"</span>, <span class="st">"BIC"</span>, <span class="st">"WMAE"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="investigating-the-preferred-model">Investigating the preferred model<a class="anchor" aria-label="anchor" href="#investigating-the-preferred-model"></a>
</h3>
<p>We have selected the 4-cluster model as the preferred representation.
We will now inspect this solution in more detail. Before we can start,
we first obtain the fitted <code>lcModel</code> object from the list of
fitted models.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kmlModel4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">kmlModels</span>, <span class="va">nClusters</span> <span class="op">==</span> <span class="fl">4</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">kmlModel4</span></span></code></pre></div>
<p>The <code>plotClusterTrajectories</code> function shows the estimated
cluster trajectories of the model.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotClusterTrajectories.html">plotClusterTrajectories</a></span><span class="op">(</span><span class="va">kmlModel4</span><span class="op">)</span></span></code></pre></div>
<p>We can get a better sense of the representation of the cluster
trajectories when plotted against the trajectories that have been
assigned to the respective cluster.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">kmlModel4</span><span class="op">)</span></span></code></pre></div>
<p>The cluster assignment for each available subject is obtained
using:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trajectoryAssignments.html">trajectoryAssignments</a></span><span class="op">(</span><span class="va">kmlModel4</span><span class="op">)</span></span></code></pre></div>
<p>We can use this to construct a table of the cluster per subject, and
merge it into the original data for further analysis.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># make sure to change the Id column name for your respective id column name</span></span>
<span><span class="va">subjectClusters</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Id <span class="op">=</span> <span class="fu"><a href="../reference/ids.html">ids</a></span><span class="op">(</span><span class="va">kmlModel4</span><span class="op">)</span>, Cluster <span class="op">=</span> <span class="fu"><a href="../reference/trajectoryAssignments.html">trajectoryAssignments</a></span><span class="op">(</span><span class="va">kmlModel4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">subjectClusters</span><span class="op">)</span></span>
<span></span>
<span><span class="va">posthocAnalysisData</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">latrendData</span>, <span class="va">subjectClusters</span>, by <span class="op">=</span> <span class="st">'Id'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">posthocAnalysisData</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">Cluster</span>, <span class="va">posthocAnalysisData</span>, <span class="va">mean</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-adequacy">Model adequacy<a class="anchor" aria-label="anchor" href="#model-adequacy"></a>
</h3>
<p>The list of currently supported internal model metrics can be
obtained by calling the <code>getInternalMetricNames</code>
function.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getInternalMetricNames.html">getInternalMetricNames</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>As an example, we will compute the APPA (a measure of cluster
separation), and the WRSS and WMAE metrics (measures of model
error).</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/metric.html">metric</a></span><span class="op">(</span><span class="va">kmlModel</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"APPA.mean"</span>, <span class="st">"WRSS"</span>, <span class="st">"WMAE"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The quantile-quantile (QQ) plot can be used to assess the model for
structural deviations.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/qqPlot.html">qqPlot</a></span><span class="op">(</span><span class="va">kmlModel4</span><span class="op">)</span></span></code></pre></div>
<p>Overall, the unexplained errors closely follow a normal distribution.
In situations where structural deviations from the expected distribution
are apparent, it may be fruitful to investigate the QQ plot on a
per-cluster basis.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/qqPlot.html">qqPlot</a></span><span class="op">(</span><span class="va">kmlModel4</span>, byCluster <span class="op">=</span> <span class="cn">TRUE</span>, detrend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="parametric-trajectory-clustering">Parametric trajectory clustering<a class="anchor" aria-label="anchor" href="#parametric-trajectory-clustering"></a>
</h2>
<p>The KML analysis has provided us with clues on an appropriate model
for the cluster trajectories. We can use these insights to define a
parametric representation of each of the trajectories and cluster them
using k-means.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lmkmMethod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcMethodLMKM.html">lcMethodLMKM</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">Time</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lmkmMethod</span></span></code></pre></div>
<p>We fit LMKM for 1 to 4 clusters.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lmkmMethods</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcMethods.html">lcMethods</a></span><span class="op">(</span><span class="va">lmkmMethod</span>, nClusters <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lmkmModels</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/latrendBatch.html">latrendBatch</a></span><span class="op">(</span><span class="va">lmkmMethods</span>, data <span class="op">=</span> <span class="va">latrendData</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotMetric.html">plotMetric</a></span><span class="op">(</span><span class="va">lmkmModels</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logLik"</span>, <span class="st">"BIC"</span>, <span class="st">"WMAE"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>All metrics clearly point to the three-cluster solution.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bestLmkmModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">lmkmModels</span>, <span class="va">nClusters</span> <span class="op">==</span> <span class="fl">3</span>, drop<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bestLmkmModel</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="comparison-to-the-reference">Comparison to the reference<a class="anchor" aria-label="anchor" href="#comparison-to-the-reference"></a>
</h2>
<p>Since we have established a preferred clustered representation of the
data heterogeneity, we can now compare the resulting cluster assignments
to the ground truth from which the <code>latrendData</code> data was
generated.</p>
<p>Using the reference assignments, we can also plot a non-parametric
estimate of the cluster trajectories. Note how it looks similar to the
cluster trajectories found by our model.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotClusterTrajectories.html">plotClusterTrajectories</a></span><span class="op">(</span><span class="va">latrendData</span>, response <span class="op">=</span> <span class="st">"Y"</span>, cluster <span class="op">=</span> <span class="st">"Class"</span><span class="op">)</span></span></code></pre></div>
<p>In order to compare the reference assignments to the trajectory
assignments generated by our model, we can create a <code>lcModel</code>
object based on the reference assignments using the
<code>lcModelPartition</code> function.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">refTrajAssigns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">Id</span>, data <span class="op">=</span> <span class="va">latrendData</span>, FUN <span class="op">=</span> <span class="fu">data.table</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/data.table/man/last.html" class="external-link">first</a></span><span class="op">)</span></span>
<span><span class="va">refModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcModelPartition.html">lcModelPartition</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">latrendData</span>, response <span class="op">=</span> <span class="st">"Y"</span>, trajectoryAssignments <span class="op">=</span> <span class="va">refTrajAssigns</span><span class="op">$</span><span class="va">Class</span><span class="op">)</span></span>
<span><span class="va">refModel</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">refModel</span><span class="op">)</span></span></code></pre></div>
<p>By constructing a reference model, we can make use of the
standardized way in which <code>lcModel</code> objects can be compared.
A list of supported comparison metrics can be obtained via the
<code>getExternalMetricNames</code> function.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getExternalMetricNames.html">getExternalMetricNames</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Lastly, we compare the agreement in trajectory assignments via the
adjusted Rand index.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/externalMetric.html">externalMetric</a></span><span class="op">(</span><span class="va">bestLmkmModel</span>, <span class="va">refModel</span>, <span class="st">"adjustedRand"</span><span class="op">)</span></span></code></pre></div>
<p>With a score of
<code>externalMetric(bestLmkmModel, refModel, "adjustedRand")</code>, we
have a near-perfect match. This result is expected, as the dataset was
generated using a growth mixture model.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Niek Den Teuling.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
