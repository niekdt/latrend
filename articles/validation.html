<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Validating cluster models â€¢ latrend</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Validating cluster models">
<meta property="og:description" content="latrend">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">latrend</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/demo.html">Demonstration of latrend package</a>
    </li>
    <li>
      <a href="../articles/implement.html">Implementing new models</a>
    </li>
    <li>
      <a href="../articles/simulation.html">Conducting a simulation study</a>
    </li>
    <li>
      <a href="../articles/validation.html">Validating cluster models</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/philips-software/latrend/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="validation_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Validating cluster models</h1>
                        <h4 data-toc-skip class="author">Niek Den Teuling</h4>
            
            <h4 data-toc-skip class="date">2020-11-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/philips-software/latrend/blob/HEAD/vignettes/validation.Rmd" class="external-link"><code>vignettes/validation.Rmd</code></a></small>
      <div class="hidden name"><code>validation.Rmd</code></div>

    </div>

    
    
<p>In this vignette we demonstrate different ways in which longitudinal cluster models can be internally validated.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/philips-software/latrend" class="external-link">latrend</a></span><span class="op">)</span></code></pre></div>
<div class="section level1">
<h1 id="demonstration">Demonstration<a class="anchor" aria-label="anchor" href="#demonstration"></a>
</h1>
<p>We explore the <code>latrendData</code> dataset. This is a synthetic dataset for which the reference group of each trajectory is available, indicated by the <code>Class</code> column. However, in this vignette we will assume that the true group specification and number of groups are unknown. Instead, we have a candidate model which we wish to validate internally.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">latrendData</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">latrendData</span><span class="op">)</span>
<span class="co">#&gt;   Id      Time           Y   Class</span>
<span class="co">#&gt; 1  1 0.0000000 -1.08049205 Class 1</span>
<span class="co">#&gt; 2  1 0.2222222 -0.68024151 Class 1</span>
<span class="co">#&gt; 3  1 0.4444444 -0.65148373 Class 1</span>
<span class="co">#&gt; 4  1 0.6666667 -0.39115398 Class 1</span>
<span class="co">#&gt; 5  1 0.8888889 -0.19407876 Class 1</span>
<span class="co">#&gt; 6  1 1.1111111 -0.02991783 Class 1</span></code></pre></div>
<p>Specify the package options to adopt the respective column names of the loaded dataset, for convenience.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>latrend.id <span class="op">=</span> <span class="st">"Id"</span>, latrend.time <span class="op">=</span> <span class="st">"Time"</span><span class="op">)</span></code></pre></div>
<div class="section level2">
<h2 id="the-candidate-model">The candidate model<a class="anchor" aria-label="anchor" href="#the-candidate-model"></a>
</h2>
<p>We consider a KML model with 3 clusters to be our candidate model that we will validate. We defined the method with a reduced number of repeated random starts (as indicated by the <code>nbRedrawing</code> argument) in order to reduce the computation time needed in the repeated evaluations below. This is only done for demonstration purposes.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">kml</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lcMethodKML.html">lcMethodKML</a></span><span class="op">(</span><span class="st">"Y"</span>, nClusters <span class="op">=</span> <span class="fl">3</span>, nbRedrawing <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="co">#&gt; Warning in rgl.init(initValue, onlyNULL): RGL: unable to open X11 display</span>
<span class="co">#&gt; Warning: 'rgl.init' failed, running with 'rgl.useNULL = TRUE'.</span>
<span class="co">#&gt; Warning: no DISPLAY variable so Tk is not available</span>
<span class="va">kml</span>
<span class="co">#&gt; lcMethodKML specifying "longitudinal k-means (KML)"</span>
<span class="co">#&gt;  time:           getOption("latrend.time")</span>
<span class="co">#&gt;  id:             getOption("latrend.id")</span>
<span class="co">#&gt;  nClusters:      3</span>
<span class="co">#&gt;  nbRedrawing:    5</span>
<span class="co">#&gt;  maxIt:          200</span>
<span class="co">#&gt;  imputationMethod:"copyMean"</span>
<span class="co">#&gt;  distanceName:   "euclidean"</span>
<span class="co">#&gt;  power:          2</span>
<span class="co">#&gt;  distance:       function() {}</span>
<span class="co">#&gt;  centerMethod:   meanNA</span>
<span class="co">#&gt;  startingCond:   "nearlyAll"</span>
<span class="co">#&gt;  nbCriterion:    1000</span>
<span class="co">#&gt;  scale:          TRUE</span>
<span class="co">#&gt;  response:       "Y"</span></code></pre></div>
</div>
</div>
<div class="section level1">
<h1 id="evaluate-stability-of-the-estimation-through-repeated-estimation">Evaluate stability of the estimation through repeated estimation<a class="anchor" aria-label="anchor" href="#evaluate-stability-of-the-estimation-through-repeated-estimation"></a>
</h1>
<p>The purpose of model validation is essentially to identify that the model is robust and generalizes well to unseen data. A necessary condition for these aspects is that the model is reproducible on the original training data. This evaluation helps to ensure that the model estimation procedure is robust, i.e., does not yield spurious model solutions.</p>
<p>We can fit a method repeatedly using the <code>latrendRep</code> data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">repModels</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/latrendRep.html">latrendRep</a></span><span class="op">(</span><span class="va">kml</span>, data <span class="op">=</span> <span class="va">latrendData</span>, .rep<span class="op">=</span><span class="fl">10</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">repModels</span>, excludeShared <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; List of 10 lcModels with</span>
<span class="co">#&gt;    .name .method        data       seed time id nClusters nbRedrawing maxIt</span>
<span class="co">#&gt; 1      1     kml latrendData 1140350788 Time Id         3           5   200</span>
<span class="co">#&gt; 2      2     kml latrendData  312928385 Time Id         3           5   200</span>
<span class="co">#&gt; 3      3     kml latrendData  866248189 Time Id         3           5   200</span>
<span class="co">#&gt; 4      4     kml latrendData 1909893419 Time Id         3           5   200</span>
<span class="co">#&gt; 5      5     kml latrendData  554504146 Time Id         3           5   200</span>
<span class="co">#&gt; 6      6     kml latrendData  884616499 Time Id         3           5   200</span>
<span class="co">#&gt; 7      7     kml latrendData  803234389 Time Id         3           5   200</span>
<span class="co">#&gt; 8      8     kml latrendData 1158971242 Time Id         3           5   200</span>
<span class="co">#&gt; 9      9     kml latrendData  934673902 Time Id         3           5   200</span>
<span class="co">#&gt; 10    10     kml latrendData 1632225031 Time Id         3           5   200</span>
<span class="co">#&gt;    imputationMethod distanceName power       distance</span>
<span class="co">#&gt; 1          copyMean    euclidean     2 function () {}</span>
<span class="co">#&gt; 2          copyMean    euclidean     2 function () {}</span>
<span class="co">#&gt; 3          copyMean    euclidean     2 function () {}</span>
<span class="co">#&gt; 4          copyMean    euclidean     2 function () {}</span>
<span class="co">#&gt; 5          copyMean    euclidean     2 function () {}</span>
<span class="co">#&gt; 6          copyMean    euclidean     2 function () {}</span>
<span class="co">#&gt; 7          copyMean    euclidean     2 function () {}</span>
<span class="co">#&gt; 8          copyMean    euclidean     2 function () {}</span>
<span class="co">#&gt; 9          copyMean    euclidean     2 function () {}</span>
<span class="co">#&gt; 10         copyMean    euclidean     2 function () {}</span>
<span class="co">#&gt;                                          centerMethod startingCond nbCriterion</span>
<span class="co">#&gt; 1  function (x, ...) {    mean(x, ..., na.rm = TRUE)}    nearlyAll        1000</span>
<span class="co">#&gt; 2  function (x, ...) {    mean(x, ..., na.rm = TRUE)}    nearlyAll        1000</span>
<span class="co">#&gt; 3  function (x, ...) {    mean(x, ..., na.rm = TRUE)}    nearlyAll        1000</span>
<span class="co">#&gt; 4  function (x, ...) {    mean(x, ..., na.rm = TRUE)}    nearlyAll        1000</span>
<span class="co">#&gt; 5  function (x, ...) {    mean(x, ..., na.rm = TRUE)}    nearlyAll        1000</span>
<span class="co">#&gt; 6  function (x, ...) {    mean(x, ..., na.rm = TRUE)}    nearlyAll        1000</span>
<span class="co">#&gt; 7  function (x, ...) {    mean(x, ..., na.rm = TRUE)}    nearlyAll        1000</span>
<span class="co">#&gt; 8  function (x, ...) {    mean(x, ..., na.rm = TRUE)}    nearlyAll        1000</span>
<span class="co">#&gt; 9  function (x, ...) {    mean(x, ..., na.rm = TRUE)}    nearlyAll        1000</span>
<span class="co">#&gt; 10 function (x, ...) {    mean(x, ..., na.rm = TRUE)}    nearlyAll        1000</span>
<span class="co">#&gt;    scale response</span>
<span class="co">#&gt; 1   TRUE        Y</span>
<span class="co">#&gt; 2   TRUE        Y</span>
<span class="co">#&gt; 3   TRUE        Y</span>
<span class="co">#&gt; 4   TRUE        Y</span>
<span class="co">#&gt; 5   TRUE        Y</span>
<span class="co">#&gt; 6   TRUE        Y</span>
<span class="co">#&gt; 7   TRUE        Y</span>
<span class="co">#&gt; 8   TRUE        Y</span>
<span class="co">#&gt; 9   TRUE        Y</span>
<span class="co">#&gt; 10  TRUE        Y</span></code></pre></div>
<p>A convenient way to assess the stability across repeated runs is to compare the models on one or more internal model metrics. Similar solutions should yield similar metric scores.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">repSelfMetrics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/metric.html">metric</a></span><span class="op">(</span><span class="va">repModels</span>, name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BIC"</span>, <span class="st">"WMAE"</span>, <span class="st">"APPA"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning in FUN(X[[i]], ...): Internal metric(s) "APPA" are not defined.</span>
<span class="co">#&gt; Returning NA.</span>

<span class="co">#&gt; Warning in FUN(X[[i]], ...): Internal metric(s) "APPA" are not defined.</span>
<span class="co">#&gt; Returning NA.</span>

<span class="co">#&gt; Warning in FUN(X[[i]], ...): Internal metric(s) "APPA" are not defined.</span>
<span class="co">#&gt; Returning NA.</span>

<span class="co">#&gt; Warning in FUN(X[[i]], ...): Internal metric(s) "APPA" are not defined.</span>
<span class="co">#&gt; Returning NA.</span>

<span class="co">#&gt; Warning in FUN(X[[i]], ...): Internal metric(s) "APPA" are not defined.</span>
<span class="co">#&gt; Returning NA.</span>

<span class="co">#&gt; Warning in FUN(X[[i]], ...): Internal metric(s) "APPA" are not defined.</span>
<span class="co">#&gt; Returning NA.</span>

<span class="co">#&gt; Warning in FUN(X[[i]], ...): Internal metric(s) "APPA" are not defined.</span>
<span class="co">#&gt; Returning NA.</span>

<span class="co">#&gt; Warning in FUN(X[[i]], ...): Internal metric(s) "APPA" are not defined.</span>
<span class="co">#&gt; Returning NA.</span>

<span class="co">#&gt; Warning in FUN(X[[i]], ...): Internal metric(s) "APPA" are not defined.</span>
<span class="co">#&gt; Returning NA.</span>

<span class="co">#&gt; Warning in FUN(X[[i]], ...): Internal metric(s) "APPA" are not defined.</span>
<span class="co">#&gt; Returning NA.</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">repSelfMetrics</span><span class="op">)</span>
<span class="co">#&gt;        BIC      WMAE APPA</span>
<span class="co">#&gt; 1 655.5420 0.1925632   NA</span>
<span class="co">#&gt; 2 655.5420 0.1925632   NA</span>
<span class="co">#&gt; 3 655.5420 0.1925632   NA</span>
<span class="co">#&gt; 4 655.0419 0.1924808   NA</span>
<span class="co">#&gt; 5 655.5420 0.1925632   NA</span>
<span class="co">#&gt; 6 655.0419 0.1924808   NA</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">repSelfMetrics</span><span class="op">[</span>, <span class="st">"WMAE"</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="co">#&gt;  0.1925  0.1925  0.1925  0.1925  0.1926  0.1926</span></code></pre></div>
<p>As can be seen from the numbers, the models are (practically) identical in terms of model fit, measurement error, and cluster separation.</p>
<div class="section level2">
<h2 id="comparison-between-fits">Comparison between fits<a class="anchor" aria-label="anchor" href="#comparison-between-fits"></a>
</h2>
<p>Alternatively, we can select the model with the best fit, and compare it against the other fitted models.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bestRepModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">repModels</span>, <span class="st">"BIC"</span><span class="op">)</span>
<span class="fu"><a href="../reference/externalMetric.html">externalMetric</a></span><span class="op">(</span><span class="va">repModels</span>, <span class="va">bestRepModel</span>, name <span class="op">=</span> <span class="st">"adjustedRand"</span><span class="op">)</span>
<span class="co">#&gt;  [1] 1 1 1 1 1 1 1 1 1 1</span></code></pre></div>
<p>As indicated by the adjusted Rand index, the methods are highly similar (a score of 1 indicates a perfect agreement). Note however that there are some discrepancies among the repeated runs on one or two trajectories.</p>
<p>Similarly, we can compute the pairwise adjusted Rand indices, resulting in a similarity matrix</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">simMat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/externalMetric.html">externalMetric</a></span><span class="op">(</span><span class="va">repModels</span>, name <span class="op">=</span> <span class="st">"adjustedRand"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">simMat</span>, <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt;    1 2 3 4 5 6 7 8 9</span>
<span class="co">#&gt; 2  1                </span>
<span class="co">#&gt; 3  1 1              </span>
<span class="co">#&gt; 4  1 1 1            </span>
<span class="co">#&gt; 5  1 1 1 1          </span>
<span class="co">#&gt; 6  1 1 1 1 1        </span>
<span class="co">#&gt; 7  1 1 1 1 1 1      </span>
<span class="co">#&gt; 8  1 1 1 1 1 1 1    </span>
<span class="co">#&gt; 9  1 1 1 1 1 1 1 1  </span>
<span class="co">#&gt; 10 1 1 1 1 1 1 1 1 1</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">simMat</span><span class="op">)</span>
<span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="co">#&gt;       1       1       1       1       1       1</span></code></pre></div>
</div>
</div>
<div class="section level1">
<h1 id="evaluating-replicability-and-stability-through-bootstrapping">Evaluating replicability and stability through bootstrapping<a class="anchor" aria-label="anchor" href="#evaluating-replicability-and-stability-through-bootstrapping"></a>
</h1>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bootModels</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/latrendBoot.html">latrendBoot</a></span><span class="op">(</span><span class="va">kml</span>, data <span class="op">=</span> <span class="va">latrendData</span>, samples <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="va">bootModels</span>
<span class="co">#&gt; List of 10 lcModels with</span>
<span class="co">#&gt;    .name .method                                       data       seed</span>
<span class="co">#&gt; 1      1     kml   bootSample(latrendData, "Id", 64231719L) 1126264256</span>
<span class="co">#&gt; 2      2     kml  bootSample(latrendData, "Id", 893996438L)   62640092</span>
<span class="co">#&gt; 3      3     kml bootSample(latrendData, "Id", 1434113967L)  359523700</span>
<span class="co">#&gt; 4      4     kml  bootSample(latrendData, "Id", 958577579L)  320237104</span>
<span class="co">#&gt; 5      5     kml bootSample(latrendData, "Id", 2079738042L)  439046689</span>
<span class="co">#&gt; 6      6     kml bootSample(latrendData, "Id", 2012583691L) 1515304167</span>
<span class="co">#&gt; 7      7     kml  bootSample(latrendData, "Id", 520205446L) 1617984507</span>
<span class="co">#&gt; 8      8     kml  bootSample(latrendData, "Id", 648143680L)   43470232</span>
<span class="co">#&gt; 9      9     kml bootSample(latrendData, "Id", 2127214623L)  446397691</span>
<span class="co">#&gt; 10    10     kml  bootSample(latrendData, "Id", 882537923L)   50033203</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bootMetrics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/metric.html">metric</a></span><span class="op">(</span><span class="va">bootModels</span>, name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BIC"</span>, <span class="st">"WMAE"</span>, <span class="st">"APPA"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning in FUN(X[[i]], ...): Internal metric(s) "APPA" are not defined.</span>
<span class="co">#&gt; Returning NA.</span>

<span class="co">#&gt; Warning in FUN(X[[i]], ...): Internal metric(s) "APPA" are not defined.</span>
<span class="co">#&gt; Returning NA.</span>

<span class="co">#&gt; Warning in FUN(X[[i]], ...): Internal metric(s) "APPA" are not defined.</span>
<span class="co">#&gt; Returning NA.</span>

<span class="co">#&gt; Warning in FUN(X[[i]], ...): Internal metric(s) "APPA" are not defined.</span>
<span class="co">#&gt; Returning NA.</span>

<span class="co">#&gt; Warning in FUN(X[[i]], ...): Internal metric(s) "APPA" are not defined.</span>
<span class="co">#&gt; Returning NA.</span>

<span class="co">#&gt; Warning in FUN(X[[i]], ...): Internal metric(s) "APPA" are not defined.</span>
<span class="co">#&gt; Returning NA.</span>

<span class="co">#&gt; Warning in FUN(X[[i]], ...): Internal metric(s) "APPA" are not defined.</span>
<span class="co">#&gt; Returning NA.</span>

<span class="co">#&gt; Warning in FUN(X[[i]], ...): Internal metric(s) "APPA" are not defined.</span>
<span class="co">#&gt; Returning NA.</span>

<span class="co">#&gt; Warning in FUN(X[[i]], ...): Internal metric(s) "APPA" are not defined.</span>
<span class="co">#&gt; Returning NA.</span>

<span class="co">#&gt; Warning in FUN(X[[i]], ...): Internal metric(s) "APPA" are not defined.</span>
<span class="co">#&gt; Returning NA.</span>
<span class="va">bootMetrics</span>
<span class="co">#&gt;         BIC      WMAE APPA</span>
<span class="co">#&gt; 1  386.5510 0.1874964   NA</span>
<span class="co">#&gt; 2  430.5063 0.1901289   NA</span>
<span class="co">#&gt; 3  374.7246 0.1859108   NA</span>
<span class="co">#&gt; 4  544.3614 0.1984359   NA</span>
<span class="co">#&gt; 5  480.6107 0.1986547   NA</span>
<span class="co">#&gt; 6  461.5246 0.1910348   NA</span>
<span class="co">#&gt; 7  410.5406 0.1845597   NA</span>
<span class="co">#&gt; 8  372.2148 0.1864856   NA</span>
<span class="co">#&gt; 9  466.8833 0.1950178   NA</span>
<span class="co">#&gt; 10 417.8994 0.1902601   NA</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">bootMetrics</span><span class="op">)</span>
<span class="co">#&gt;         BIC        WMAE        APPA </span>
<span class="co">#&gt; 434.5816773   0.1907985          NA</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">bootMetrics</span>, <span class="fl">2</span>, <span class="va">sd</span><span class="op">)</span>
<span class="co">#&gt;          BIC         WMAE         APPA </span>
<span class="co">#&gt; 54.356727198  0.005065835           NA</span></code></pre></div>
</div>
<div class="section level1">
<h1 id="ten-fold-cross-validation">Ten-fold cross validation<a class="anchor" aria-label="anchor" href="#ten-fold-cross-validation"></a>
</h1>
<p>Lastly, we can fit models using <span class="math inline">\(k\)</span>-fold cross-validation to validate the models on previously unseen data from the test folds.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">trainModels</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/latrendCV.html">latrendCV</a></span><span class="op">(</span><span class="va">kml</span>, data <span class="op">=</span> <span class="va">latrendData</span>, folds <span class="op">=</span> <span class="fl">10</span>, seed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">trainModels</span>
<span class="co">#&gt; List of 10 lcModels with</span>
<span class="co">#&gt;    .name .method                                           data       seed</span>
<span class="co">#&gt; 1      1     kml  trainFold(latrendData, fold = 1, "Id", 10, 1)  778402354</span>
<span class="co">#&gt; 2      2     kml  trainFold(latrendData, fold = 2, "Id", 10, 1) 1162807070</span>
<span class="co">#&gt; 3      3     kml  trainFold(latrendData, fold = 3, "Id", 10, 1)  117301597</span>
<span class="co">#&gt; 4      4     kml  trainFold(latrendData, fold = 4, "Id", 10, 1) 1602292808</span>
<span class="co">#&gt; 5      5     kml  trainFold(latrendData, fold = 5, "Id", 10, 1)  595415630</span>
<span class="co">#&gt; 6      6     kml  trainFold(latrendData, fold = 6, "Id", 10, 1)  665002458</span>
<span class="co">#&gt; 7      7     kml  trainFold(latrendData, fold = 7, "Id", 10, 1)  950483445</span>
<span class="co">#&gt; 8      8     kml  trainFold(latrendData, fold = 8, "Id", 10, 1)  564460360</span>
<span class="co">#&gt; 9      9     kml  trainFold(latrendData, fold = 9, "Id", 10, 1) 1404535239</span>
<span class="co">#&gt; 10    10     kml trainFold(latrendData, fold = 10, "Id", 10, 1)  779295076</span></code></pre></div>
<div class="section level2">
<h2 id="manual-cross-validation">Manual cross validation<a class="anchor" aria-label="anchor" href="#manual-cross-validation"></a>
</h2>
<p>Alternatively, we can generate the training data folds ourselves, and fit models using <code>latrendBatch</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataFolds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createTrainDataFolds.html">createTrainDataFolds</a></span><span class="op">(</span><span class="va">latrendData</span>, folds <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="va">foldModels</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/latrendBatch.html">latrendBatch</a></span><span class="op">(</span><span class="va">kml</span>, data <span class="op">=</span> <span class="va">dataFolds</span><span class="op">)</span>
<span class="va">foldModels</span>
<span class="co">#&gt; List of 10 lcModels with</span>
<span class="co">#&gt;    .name .method            data       seed</span>
<span class="co">#&gt; 1      1     kml  dataFolds[[1]]   26926021</span>
<span class="co">#&gt; 2      2     kml  dataFolds[[2]] 1943230904</span>
<span class="co">#&gt; 3      3     kml  dataFolds[[3]] 1181228795</span>
<span class="co">#&gt; 4      4     kml  dataFolds[[4]] 1907309274</span>
<span class="co">#&gt; 5      5     kml  dataFolds[[5]] 1135519048</span>
<span class="co">#&gt; 6      6     kml  dataFolds[[6]] 1705419739</span>
<span class="co">#&gt; 7      7     kml  dataFolds[[7]]  955514422</span>
<span class="co">#&gt; 8      8     kml  dataFolds[[8]]  376276510</span>
<span class="co">#&gt; 9      9     kml  dataFolds[[9]]  225308591</span>
<span class="co">#&gt; 10    10     kml dataFolds[[10]]  778273294</span></code></pre></div>
<p>The list of test data folds is obtained using</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">testDataFolds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createTestDataFolds.html">createTestDataFolds</a></span><span class="op">(</span><span class="va">latrendData</span>, <span class="va">dataFolds</span><span class="op">)</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Niek Den Teuling.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
